import time
import sys

try:
    import Jetson.GPIO as GPIO
except ImportError:
    print("!!! Error: ‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ Jetson.GPIO")
    sys.exit(1)

# --- CONFIG ---
SENSOR_PIN = 31  # ‡πÉ‡∏ä‡πâ‡∏Ç‡∏≤ 31 ‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏ó‡∏™‡∏ú‡πà‡∏≤‡∏ô

def main():
    
    GPIO.setmode(GPIO.BOARD)
    
    # ---------------------------------------------------------
    # [UPDATED] ‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏õ‡πá‡∏ô Input ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß (‡πÑ‡∏°‡πà‡∏™‡∏±‡πà‡∏á Pull up/down)
    # ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÄ‡∏£‡∏≤‡∏°‡∏µ‡∏ï‡∏±‡∏ß‡∏ï‡πâ‡∏≤‡∏ô‡∏ó‡∏≤‡∏ô‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å (External Resistor) ‡∏ó‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß
    # ---------------------------------------------------------
    GPIO.setup(SENSOR_PIN, GPIO.IN) 
    
    print(f"\n--- ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏ã‡∏ô‡πÄ‡∏ã‡∏≠‡∏£‡πå (Pin {SENSOR_PIN}) [External Pull-up Only] ---")
    print("1. ‡∏•‡∏≠‡∏á‡πÄ‡∏≠‡∏≤‡∏ô‡∏¥‡πâ‡∏ß‡∏≠‡∏∏‡∏î‡∏´‡∏±‡∏ß‡∏î‡∏π‡∏î (‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡∏•‡∏°‡∏î‡πâ‡∏ß‡∏¢‡∏°‡∏∑‡∏≠)")
    print("2. ‡∏ñ‡πâ‡∏≤‡∏î‡∏π‡∏î‡∏ï‡∏¥‡∏î -> ‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏∂‡πâ‡∏ô 0 (Active)")
    print("3. ‡∏ñ‡πâ‡∏≤‡∏õ‡∏•‡πà‡∏≠‡∏¢  -> ‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏∂‡πâ‡∏ô 1 (Idle)")
    print("(‡∏Å‡∏î Ctrl+C ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏ö)\n")
    
    try:
        while True:
            val = GPIO.input(SENSOR_PIN)
            
            if val == 0:
                status = "‚úÖ ‡∏î‡∏π‡∏î‡∏ï‡∏¥‡∏î (GRIPPED) - [0]"
            else:
                status = "üî¥ ‡πÑ‡∏°‡πà‡∏ï‡∏¥‡∏î (EMPTY)   - [1]"
            
            # ‡∏õ‡∏£‡∏¥‡πâ‡∏ô‡∏ó‡πå‡∏ó‡∏±‡∏ö‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÄ‡∏î‡∏¥‡∏°
            print(f"\r‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: {status}        ", end="")
            time.sleep(0.1)
            
    except KeyboardInterrupt:
        print("\n\n>>> ‡∏à‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô")
    finally:
        GPIO.cleanup()

if __name__ == "__main__":
    main()